<div [formGroup]="parentForm" class="panel panel-level-{{panelLevel}}">
    <div class="panel-heading group-header">
        <span class="panel-title cursor-ptr" tabindex="0"
            (keyup.space)="toggleGroup($event)"
            (keyup.enter)="toggleGroup($event)"
            (click)="toggleGroup($event)">
            <i class="glyphicon"
               [ngClass]="{'glyphicon-minus-sign': isGroupOpen, 'glyphicon-plus-sign': !isGroupOpen}">
            </i>
            {{getItemName() + (isMultiple ? 's' : '')}}
        </span>
        <span class="pull-right" [hidden]="!isMultiple && items.length >= 1">
            <button class="btn btn-similar btn-xs" title="Add a new {{getItemName()}}"
                    [disabled]="!isEditable"
                    (click)="addNew($event); miscUtils.showFullView($event);">
                <i class="glyphicon glyphicon-plus-sign"></i>
                New <span class="hidden-xxs">{{getItemName()}}</span>
            </button>
        </span>
    </div>
    <div class="panel-body group-body" [hidden]="!isGroupOpen">
        <div *ngIf="!hasItems()">
            No information available for {{getItemName() + (isMultiple ? 's' : '')}}
        </div>
        <div *ngFor="let item of items; let i = index">
            <ng-template [ngTemplateOutlet]="getTemplate()" [ngOutletContext]="{ form: parentForm, item: item, i: i, event: geodesyEvent, returnEvents: returnEvents }"></ng-template>
        </div>
    </div>
</div>

<ng-template #frequencyStandardTmpl let-form="form" let-item="item" let-i="i" let-event="event" let-returnEvents="returnEvents">
    <frequency-standard-item [groupArray]="form"
                             [item]="item"
                             [index]="i"
                             [geodesyEvent]="event"
                             (returnEvents)="returnEvents($event)">
    </frequency-standard-item>
</ng-template>
<ng-template #gnssAntennaTmpl let-form="form" let-item="item" let-i="i" let-event="event" let-returnEvents="returnEvents">
    <gnss-antenna-item [groupArray]="form"
                       [item]="item"
                       [index]="i"
                       [geodesyEvent]="event"
                       (returnEvents)="returnEvents($event)">
    </gnss-antenna-item>
</ng-template>
<ng-template #gnssReceiverTmpl let-form="form" let-item="item" let-i="i" let-event="event" let-returnEvents="returnEvents">
    <gnss-receiver-item [groupArray]="form"
                        [item]="item"
                        [index]="i"
                        [geodesyEvent]="event"
                        (returnEvents)="returnEvents($event)">
    </gnss-receiver-item>
</ng-template>
<ng-template #humiditySensorTmpl let-form="form" let-item="item" let-i="i" let-event="event" let-returnEvents="returnEvents">
    <humidity-sensor-item [groupArray]="form"
                          [item]="item"
                          [index]="i"
                          [geodesyEvent]="event"
                          (returnEvents)="returnEvents($event)">
    </humidity-sensor-item>
</ng-template>
<ng-template #localEpisodicEffectTmpl let-form="form" let-item="item" let-i="i" let-event="event" let-returnEvents="returnEvents">
    <local-episodic-effect-item [groupArray]="form"
                                [item]="item"
                                [index]="i"
                                [geodesyEvent]="event"
                                (returnEvents)="returnEvents($event)">
    </local-episodic-effect-item>
</ng-template>
<ng-template #multipathSourceTmpl let-form="form" let-item="item" let-i="i" let-event="event" let-returnEvents="returnEvents">
    <multipath-source-item [groupArray]="form"
                           [item]="item"
                           [index]="i"
                           [geodesyEvent]="event"
                           (returnEvents)="returnEvents($event)">
    </multipath-source-item>
</ng-template>
<ng-template #pressureSensorTmpl let-form="form" let-item="item" let-i="i" let-event="event" let-returnEvents="returnEvents">
    <pressure-sensor-item [groupArray]="form"
                          [item]="item"
                          [index]="i"
                          [geodesyEvent]="event"
                          (returnEvents)="returnEvents($event)">
    </pressure-sensor-item>
</ng-template>
<ng-template #radioInterferenceTmpl let-form="form" let-item="item" let-i="i" let-event="event" let-returnEvents="returnEvents">
    <radio-interference-item [groupArray]="form"
                             [item]="item"
                             [index]="i"
                             [geodesyEvent]="event"
                             (returnEvents)="returnEvents($event)">
    </radio-interference-item>
</ng-template>
<ng-template #signalObstructionTmpl let-form="form" let-item="item" let-i="i" let-event="event" let-returnEvents="returnEvents">
    <signal-obstruction-item [groupArray]="form"
                             [item]="item"
                             [index]="i"
                             [geodesyEvent]="event"
                             (returnEvents)="returnEvents($event)">
    </signal-obstruction-item>
</ng-template>
<ng-template #surveyedLocalTieTmpl let-form="form" let-item="item" let-i="i" let-event="event" let-returnEvents="returnEvents">
    <surveyed-local-tie-item [groupArray]="form"
                             [item]="item"
                             [index]="i"
                             [geodesyEvent]="event"
                             (returnEvents)="returnEvents($event)">
    </surveyed-local-tie-item>
</ng-template>
<ng-template #temperatureSensorTmpl let-form="form" let-item="item" let-i="i" let-event="event" let-returnEvents="returnEvents">
    <temperature-sensor-item [groupArray]="form"
                             [item]="item"
                             [index]="i"
                             [geodesyEvent]="event"
                             (returnEvents)="returnEvents($event)">
    </temperature-sensor-item>
</ng-template>
<ng-template #waterVaporSensorTmpl let-form="form" let-item="item" let-i="i" let-event="event" let-returnEvents="returnEvents">
    <water-vapor-sensor-item [groupArray]="form"
                             [item]="item"
                             [index]="i"
                             [geodesyEvent]="event"
                             (returnEvents)="returnEvents($event)">
    </water-vapor-sensor-item>
</ng-template>
<ng-template #responsiblePartyTmpl let-form="form" let-item="item" let-i="i" let-event="event" let-returnEvents="returnEvents">
    <gnss-responsible-party-item [groupArray]="form"
                                 [partyType]="partyType"
                                 [item]="item"
                                 [index]="i"
                                 [total]="items.length"
                                 [isMandatory]="isMandatory"
                                 [geodesyEvent]="event"
                                 (returnEvents)="returnEvents($event)">
    </gnss-responsible-party-item>
</ng-template>
